Execute (Set completefunc):
    setlocal completefunc=fortify#Complete

Include: fixtures/basic.xml

Do (Complete!):
# Completion does not work when <xml ...> is indented, so removing the indentation
# and after doing the completion remove the first line (<xml ...>)
# I had to add three whitespaces after the completion ("and fc.function   ") in the
# expected result
    ggV<
    21j
    oand fc.\<C-X>\<C-U>\<C-U> 
    \<Esc>ggdd

Expect:
    <RulePack xmlns="xmlns://www.fortifysoftware.com/schema/rules" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="RulePack">
        <Rules version="3.2">
            <RuleDefinitions>
                <StructuralRule formatVersion="3.2" language="java">
                    <MetaInfo>
                        <Group name="package">test</Group>
                    </MetaInfo>
                    <RuleID>B100B36C-E4A6-4ED0-85CC-41C4C8627996</RuleID>
                    <VulnKingdom>test</VulnKingdom>
                    <VulnCategory>test</VulnCategory>
                    <DefaultSeverity>5.0</DefaultSeverity>
                    <Description/>
                    <Predicate><![CDATA[
                        FunctionCall fc: name == "println"
                            and fc.enclosingFunction is [Function f:
                                name == "foo3"
                                //and f.callers contains [Function c1: name == "foo1" ]
                                and f.callers contains [Function c2: name == "foo2" ]
                            ]
                            and fc.sourceLocation.startLine is [Number l:]
                            and fc.function.filename is [Label:]
                            and fc.function   
                    ]]></Predicate>
                </StructuralRule>
            </RuleDefinitions>
        </Rules>
    </RulePack>
